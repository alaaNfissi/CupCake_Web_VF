{% extends "base.html.twig" %}

{% block pageTitle %}
    My Profile Cup Cake !
{% endblock %}

{% block head %}
    <link rel="stylesheet" href="{{ asset('assets/css/material-kit.css?v=2.0.2') }}">
    {{ parent() }}
{% endblock %}

{% block body %}
    {% block pageClass %}
        <body class="profile-page ">
    {% endblock %}

    {% block navbar %}
        {{ parent() }}
    {% endblock %}

    {% block main %}

        <div class="page-header header-filter" data-parallax="true" style="background-image: url(https://source.unsplash.com/collection/1976913/);"></div>
        {% if testDelete==-1 %}
        <div class="alert alert-danger" style="z-index: 5000">
            <div class="container">
                <div class="alert-icon">
                    <i class="material-icons">error_outline</i>
                </div>
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true"><i class="material-icons">clear</i></span>
                </button>
                <b>Error Alert:</b> Vous avez depasser la date limite d'annulation, Vous ne pouvez plus annulez !
            </div>
        </div>
        {% endif %}
        <div class="main main-raised">
            <div class="profile-content">
                <div class="container">

                    <div class="row">
                        <div class="col-md-6 ml-auto mr-auto">
                            <div class="profile">
                                <div class="avatar">
                                    <img src="{{ app.user.image }}" alt="Circle Image" class="img-raised rounded-circle img-fluid">
                                </div>
                                <div class="name">
                                    <h3 class="title">{{ app.user.nom }} {{ app.user.prenom }}</h3>
                                    <h6>Cake Lover</h6>
                                    <a href="#" class="btn btn-just-icon btn-link btn-facebook"><i class="fa fa-facebook"></i></a>
                                    <a href="#" class="btn btn-just-icon btn-link btn-twitter"><i class="fa fa-twitter"></i></a>
                                    <a href="#" class="btn btn-just-icon btn-link btn-instagram"><i class="fa fa-instagram"></i></a>
                                </div>
                            </div>
                            <div class="follow">
                                <a href="{{ path('fos_user_profile_edit') }}">
                                    <button class="btn btn-fab btn-primary btn-round" rel="tooltip" title="Edit your profile">
                                        <i class="material-icons">edit</i>
                                    </button>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="description text-center">
                        <p>An artist of considerable range, Chet Faker &#x2014; the name taken by Melbourne-raised, Brooklyn-based Nick Murphy &#x2014; writes, performs and records all of his own music, giving it a warm, intimate feel with a solid groove structure. </p>
                    </div>
                    <div class="row">
                        <div class="col-md-6 ml-auto mr-auto">
                            <div class="profile-tabs">
                                <ul class="nav nav-pills nav-pills-icons justify-content-center" role="tablist">
                                    <!--
                          color-classes: "nav-pills-primary", "nav-pills-info", "nav-pills-success", "nav-pills-warning","nav-pills-danger"
                      -->
                                    <li class="nav-item">
                                        <a class="nav-link active" href="#work" role="tab" data-toggle="tab">
                                            <i class="material-icons">palette</i> Work
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="#connections" role="tab" data-toggle="tab">
                                            <i class="material-icons">people</i>Mes Commandes
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="#media" role="tab" data-toggle="tab">
                                            <i class="material-icons">camera</i> Media
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="tab-content tab-space">
                        <div class="tab-pane active work" id="work">
                            <div class="row">
                                <div class="col-md-7 ml-auto mr-auto ">
                                    <h4 class="title">Latest Collections</h4>
                                    <div class="row collections">
                                        <div class="col-md-6">
                                            <div class="card card-background" style="background-image: url({{ asset('assets/img/kit/pro/examples/mariya-georgieva.jpg') }})">
                                                <a href="#"></a>
                                                <div class="card-body">
                                                    <label class="badge badge-warning">Spring 2016</label>
                                                    <a href="#">
                                                        <h2 class="card-title">Stilleto</h2>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="card card-background" style="background-image: url({{ asset('assets/img/kit/pro/examples/clem-onojeghuo.jpg') }})">
                                                <a href="#"></a>
                                                <div class="card-body">
                                                    <label class="badge badge-info">Spring 2016</label>
                                                    <a href="#">
                                                        <h2 class="card-title">High Heels</h2>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="card card-background" style="background-image: url({{ asset('assets/img/kit/pro/examples/olu-eletu.jpg') }})">
                                                <a href="#"></a>
                                                <div class="card-body">
                                                    <label class="badge badge-danger">Summer 2016</label>
                                                    <a href="#">
                                                        <h2 class="card-title">Flats</h2>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="card card-background" style="background-image: url({{ asset('assets/img/kit/pro/examples/darren-coleshill.jpg') }})">
                                                <a href="#"></a>
                                                <div class="card-body">
                                                    <label class="badge badge-success">Winter 2015</label>
                                                    <a href="#">
                                                        <h2 class="card-title">Men's Sneakers</h2>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-2 mr-auto ml-auto stats">
                                    <h4 class="title">Stats</h4>
                                    <ul class="list-unstyled">
                                        <li>
                                            <b>60</b> Products</li>
                                        <li>
                                            <b>4</b> Collections</li>
                                        <li>
                                            <b>331</b> Influencers</li>
                                        <li>
                                            <b>1.2K</b> Likes</li>
                                    </ul>
                                    <hr>
                                    <h4 class="title">About his Work</h4>
                                    <p class="description">French luxury footwear and fashion. The footwear has incorporated shiny, red-lacquered soles that have become his signature.</p>
                                    <hr>
                                    <h4 class="title">Focus</h4>
                                    <span class="badge badge-primary">Footwear</span>
                                    <span class="badge badge-rose">Luxury</span>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane connections" id="connections">
                            <div class="container-fluid">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="card">
                                            <div class="card-header card-header-primary card-header-icon">
                                                <div class="card-icon">
                                                    <i class="material-icons">assignment</i>
                                                </div>
                                                <h4 class="card-title">Table des Commandes</h4>
                                            </div>
                                            <div class="card-body">
                                                <div class="toolbar">
                                                    <!--        Here you can write extra buttons/actions for the toolbar              -->
                                                </div>
                                                <div class="material-datatables">
                                                    <table id="datatables" class="table table-striped table-no-bordered table-hover" cellspacing="0" width="100%" style="width:100%">
                                                        <thead>
                                                        <tr>
                                                            <th>Numéro de commande</th>
                                                            <th>Date de la commande</th>
                                                            <th>Prix Totale</th>
                                                            {#<th>Panier</th>#}
                                                            {#<th>Age</th>#}
                                                            {#<th>Date</th>#}
                                                            <th class="disabled-sorting text-right">Actions</th>
                                                        </tr>
                                                        </thead>
                                                        <tfoot>
                                                        <tr>
                                                            <th>Numéro de commande</th>
                                                            <th>Date de la commande</th>
                                                            <th>Prix Totale</th>
                                                            {#<th>Panier</th>#}
                                                            {#<th>Age</th>#}
                                                            {#<th>Start date</th>#}
                                                            <th class="text-right">Actions</th>
                                                        </tr>
                                                        </tfoot>
                                                        <tbody>
                                                        {% set i=0 %}
                                                        {% for commande in commandes %}
                                                            <tr>
                                                                <td>{{ commande.numCommande}}</td>
                                                                <td>{{ commande.dateCommande|date }}</td>
                                                                <td>{{ commande.prixTotale }}</td>
                                                                {#<td>{{ commande.panier.idpanier }}</td>#}
                                                                <td class="text-right">
                                                                    <a href="#" class="btn btn-link btn-warning btn-just-icon edit" data-toggle="modal" data-target="#signupModal_{{ i }}"><i class="material-icons" data-placement="top" title="Détails Panier et Livraison" data-container="body" data-toggle="tooltip">remove_red_eye</i></a>
                                                                    <button value="{{ path('commande_delete',{'id':livraisons[i].idLivraison,'etat':3 }) }}" hidden id="urlBtn"></button>
                                                                    <a class="btn btn-link btn-danger btn-just-icon" data-toggle="modal" data-target="#smallAlertModal"><i class="material-icons" data-toggle="tooltip" data-placement="top" title="Annuler La Commande" data-container="body">remove_shopping_cart</i></a>
                                                                    <a href="#" class="btn btn-link btn-primary btn-just-icon remove"><i class="material-icons" data-toggle="tooltip" data-placement="top" title="Cacher" data-container="body">visibility_off</i></a>
                                                                </td>
                                                            </tr>
                                                            {% set i=i+1 %}
                                                        {% endfor %}
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane text-center gallery" id="media">
                            <div class="row">
                                <div class="col-md-3 ml-auto">
                                    <img src="{{ asset('assets/img/kit/pro/examples/mariya-georgieva.jpg') }}" class="rounded">
                                    <img src="{{ asset('assets/img/kit/pro/examples/clem-onojegaw.jpg') }}" class="rounded">
                                </div>
                                <div class="col-md-3 mr-auto">
                                    <img src="{{ asset('assets/img/kit/pro/examples/clem-onojeghuo.jpg') }}" class="rounded">
                                    <img src="{{ asset('assets/img/kit/pro/examples/olu-eletu.jpg') }}" class="rounded">
                                    <img src="{{ asset('assets/img/kit/pro/examples/cynthia-del-rio.jpg') }}" class="rounded">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    {% endblock %}

    {% block footer %}
        {{ parent() }}
    {% endblock %}

    {% block scripts %}
        <div class="modal fade" id="smallAlertModal" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-small" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="material-icons">clear</i></button>
                    </div>
                    <div class="modal-body text-center">
                        <h5>Etes vous sur ? </h5>
                    </div>
                    <div class="modal-footer justify-content-center">
                        <button type="button" class="btn btn-link" data-dismiss="modal">Non</button>
                        <button type="button" id="confirmerAnnulation" class="btn btn-success btn-link">Oui</button>
                    </div>
                </div>
            </div>
        </div>
        {% set j=0 %}
        {% for commande in commandes %}
        {% if j<commandes|length %}
        {% for produits in ttProduits %}
        <div class="modal fade" id="signupModal_{{ j }}" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-signup" role="document">
                <div class="modal-content">
                    <div class="card card-signup card-plain">
                        <div class="modal-header">
                            <h5 class="modal-title card-title">Le panier de cette commande{{ j }}</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <i class="material-icons">clear</i>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-12">
                                    <h4>La livraison</h4>
                                </div>
                                <table class="table table-shopping">
                                    <thead>
                                    <tr>
                                        {#<th class="text-center"></th>#}
                                        <th class="text-left">Date Livraison</th>
                                        <th class="text-left">Prix Livraison</th>
                                        <th class="text-left">Etat Livraison</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% if livraisons[j] != null %}
                                        <tr>
                                            <td>{{ livraisons[j].dateLivraison|date }}</td>
                                            <td>{{ livraisons[j].prixLivraison }}</td>
                                            <td>
                                                <select class="selectpicker " name="etat" id="dynamic_select" data-style="select-with-transition" title="Single Select" data-size="7">
                                                    {% if livraisons[j].etatlivraison == 0 %}
                                                        <option value="0" selected>{{ livraisons[j].etatLivraionString[0] }}</option>
                                                        <option value="1" disabled>{{ livraisons[j].etatLivraionString[1] }}</option>
                                                        <option value="2" disabled>{{ livraisons[j].etatLivraionString[2] }}</option>
                                                        <option value="3" disabled>{{ livraisons[j].etatLivraionString[3] }}</option>
                                                    {% elseif livraisons[j].etatlivraison == 1 %}
                                                        <option value="0" disabled>{{ livraisons[j].etatLivraionString[0] }}</option>
                                                        <option value="1" selected>{{ livraisons[j].etatLivraionString[1] }}</option>
                                                        <option value="2" disabled>{{ livraisons[j].etatLivraionString[2] }}</option>
                                                        <option value="3" disabled>{{ livraisons[j].etatLivraionString[3] }}</option>
                                                    {% elseif livraisons[j].etatlivraison == 2 %}
                                                        <option value="0" disabled>{{ livraisons[j].etatLivraionString[0] }}</option>
                                                        <option value="1" disabled>{{ livraisons[j].etatLivraionString[1] }}</option>
                                                        <option value="2" selected>{{ livraisons[j].etatLivraionString[2] }}</option>
                                                        <option value="3" disabled>{{ livraisons[j].etatLivraionString[3] }}</option>
                                                    {% else %}
                                                        <option value="0" disabled>{{ livraisons[j].etatLivraionString[0] }}</option>
                                                        <option value="1" disabled>{{ livraisons[j].etatLivraionString[1] }}</option>
                                                        <option value="2" disabled>{{ livraisons[j].etatLivraionString[2] }}</option>
                                                        <option value="3" selected>{{ livraisons[j].etatLivraionString[3] }}</option>
                                                    {% endif %}
                                                </select>
                                            </td>
                                            {#<td>#}
                                            {#<a href="{{ path('livraison_modifier',{'id': livraisons[j].IdLivraison,'etat': 2}) }}">Modifier</a>#}
                                            {#</td>#}
                                            {#<td>{{ livraisons[j].etatLivraionString[livraisons[j].etatlivraison] }}</td>#}
                                        </tr>
                                    {% endif %}
                                    </tbody>
                                </table>
                                <div class="col-md-12">
                                    <hr/>
                                </div>
                                <div class="col-md-12">
                                    <h4>Les produits de ce panier</h4>
                                </div>
                                <div class="col-lg-12 col-md-12 ml-auto mr-auto">
                                    <div class="table-responsive">
                                        <table class="table table-shopping">
                                            <thead>
                                            <tr>
                                                <th class="text-center"></th>
                                                <th>Produit</th>
                                                <th class="th-description">Categorie</th>
                                                <th class="th-description text-right">Note</th>
                                                <th class="text-center">Prix</th>
                                                {#<th class="text-right">Quantite</th>#}
                                                {#<th class="text-right">Amount</th>#}
                                                <th></th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            {% set prixT=0 %}
                                            {% for produit in produits %}
                                                {% set prixT= prixT+produit.prix %}
                                                <tr>
                                                    <td>
                                                        <div class="img-container">
                                                            <img src="{{ produit.image }}" alt="...">
                                                        </div>
                                                    </td>
                                                    <td class="td-name">
                                                        <a href="#"> {{ produit.libelleProduit }} </a>
                                                        <br>
                                                        <small>{{ produit.description }}</small>
                                                    </td>
                                                    <td>
                                                        {{ produit.categorie }}
                                                    </td>
                                                    <td class="text-center">
                                                        {{ produit.note }}
                                                    </td>
                                                    <td class="td-number text-center">
                                                        <small>&#x20AC;</small>{{ produit.prix }}
                                                    </td>
                                                    {#<td class="td-number">#}
                                                    {#{{ commande.panier.idpanier }}#}
                                                    {#<div class="btn-group">#}
                                                    {#<button class="btn btn-round btn-info btn-sm" id="plus1Produit"> <i class="material-icons">remove</i> </button>#}
                                                    {#<button class="btn btn-round btn-info btn-sm" id="minus1Produit"> <i class="material-icons">add</i> </button>#}
                                                    {#</div>#}
                                                    {#</td>#}
                                                    {#<td class="td-number text-center">#}
                                                    {#<small>&#x20AC;</small>549#}
                                                    {#</td>#}
                                                    {#<td class="td-actions">#}
                                                    {#<button type="button" rel="tooltip" data-placement="left" title="Remove item" class="btn btn-link">#}
                                                    {#<i class="material-icons">close</i>#}
                                                    {#</button>#}
                                                    {#</td>#}
                                                </tr>
                                            {% endfor %}
                                            <td colspan="3">
                                            </td>
                                            <td class="td-total">
                                                Total
                                            </td>
                                            <td class="td-price text-center">
                                                <small>&#x20AC;</small>{{ prixT }}
                                            </td>
                                            {#<td colspan="3" class="text-right">#}
                                            {#<button type="button" class="btn btn-info btn-round">Complete Purchase <i class="material-icons">keyboard_arrow_right</i></button>#}
                                            {#</td>#}
                                            {#</tr>#}
                                            {#<tr>#}
                                            {#<td colspan="3" class="text-right">#}
                                            {#<a href="#">#}
                                            {#<button type="button" class="btn btn-info btn-round">Complete Purchase <i class="material-icons">keyboard_arrow_right</i></button>#}
                                            {#</a>#}
                                            {#</td>#}
                                            {#</tr>#}
                                            </tbody>
                                        </table>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% set j=j+1 %}
        {% endfor %}

        {#{% set j=j+1 %}#}
        {% endif %}
        {% endfor %}
        {{ parent() }}
        <!--  DataTables.net Plugin, full documentation here: https://datatables.net/    -->
        <script src="{{ asset('assets/js/plugins/jquery.datatables.js') }}"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                $('#datatables').DataTable({
                    "pagingType": "full_numbers",
                    "lengthMenu": [
                        [10, 25, 50, -1],
                        [10, 25, 50, "All"]
                    ],
                    responsive: true,
                    language: {
                        search: "_INPUT_",
                        searchPlaceholder: "Rechercher Commande",
                    }

                });


                var table = $('#datatables').DataTable();

                // Edit record
                // table.on('click', '.edit', function() {
                //     $tr = $(this).closest('tr');
                //
                //     var data = table.row($tr).data();
                //     alert('You press on Row: ' + data[0] + ' ' + data[1] + ' ' + data[2] + '\'s row.');
                // });

                // Delete a record
                table.on('click', '.remove', function(e) {
                    $tr = $(this).closest('tr');
                    table.row($tr).remove().draw();
                    e.preventDefault();
                });

                //Like record
                // table.on('click', '.like', function() {
                //     alert('You clicked on Like button');
                // });

                $('.card .material-datatables label').addClass('form-group');

                $(function(){
                    $('#confirmerAnnulation').on('click', function () {
                        var url = $('#urlBtn').val();
                        if (url) {
                            window.location = url;
                        }
                        return false;
                    });
                });

            });
        </script>
        <!--  Google Maps Plugin  -->
        <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBNduoRB6rgeXnHvjbppiJphh5p-KpT8Jc"></script>
    {% endblock %}
    </body>
{% endblock %}